<!-- minify html -->
<!doctype html>
<html lang=en>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>documentreview.law</title>
<link rel=stylesheet href=https://use.typekit.net/hdi0iou.css>
<script>var tlJsHost="https:"===window.location.protocol?"https://secure.trust-provider.com/":"http://www.trustlogo.com/";document.write(unescape("%3Cscript src='"+tlJsHost+"trustlogo/javascript/trustlogo.js' type='text/javascript'%3E%3C/script%3E"))</script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js></script>
<script src=https://unpkg.com/mammoth/mammoth.browser.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js></script>

<!-- CSS Starts Here -->
<style>
            
    button,input[type=text],select{padding:0 2px;margin:2px;border-radius:4px;font-size:16px}body,button,html,select{font-weight:400;font-style:normal;font-family:apparat-light,serif}button:active,button:disabled{background-color:rgba(255,255,255,.3)}#search-text,body,button,html,input[type=text],select{font-family:apparat-light,serif}#toolbar,body,button,html,input[type=text],select{font-style:normal}#help-window,#toolbar{box-shadow:0 0 10px rgba(0,0,0,.5)}#docreview-logo,#help-window,#main-content,#security-logo,button,select{text-align:center}#pinned-list,#results-list,#tag-list{padding:0;margin:0;list-style:none}#tag-list,.button-group,.popup-content{display:flex;gap:10px}#toolbar,a{color:#fff}#tag-list li,.close-btn,.icon-button,a{cursor:pointer}body,html{margin:0;padding:0;height:100%;background-color:#34323e;display:flex;flex-direction:column}#toolbar{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-around;padding:10px 10px 20px;z-index:2;background-color:rgba(0,0,0,.3);font-family:apparat,serif;font-weight:700}#docreview-logo img{border-radius:10px;width:250px}#content{display:flex;height:calc(100% - 50px);overflow:hidden;padding-top:40px}#main-content{flex-grow:1;overflow:auto;position:relative}#docx-viewer,#image-viewer,#pdf-viewer,#txt-viewer,#xlsx-viewer{width:8.5in;height:11in;margin:auto;padding:40px;box-shadow:0 0 10px rgba(0,0,0,.5);display:none;z-index:10}#pdf-viewer canvas{width:100%;height:100%}#docx-viewer,#txt-viewer,#xlsx-viewer{background-color:#fff;overflow-y:auto;text-align:left}#image-viewer{max-width:100%;max-height:100%;transform-origin:center;transition:transform .2s}#security-logo img{width:100px}input[type=text]{background-color:rgba(255,255,255,.4);color:rgba(255,255,255,.8);font-weight:700}button{width:35px;border:2px solid rgba(255,255,255,.8);border-radius:4px;background-color:rgba(255,255,255,.5);font-size:12px}#document-select,#search-text{border:2px solid #fff}button:hover{background-color:rgba(255,255,255,.8)}button:disabled{border:2px solid rgba(255,255,255,.3);cursor:not-allowed}::placeholder{color:rgba(255,255,255,.8);font-family:apparat-light,serif;font-weight:700;font-style:normal;opacity:1}::-ms-input-placeholder{font-family:apparat-light,serif;font-weight:700;font-style:normal;color:#fff}#search-text{font-weight:700;font-style:normal}#document-select,#help-window,#search-results-container,a{font-family:apparat-light,serif;font-weight:400;font-style:normal}#help-window,#tag-popup{left:50%;background-color:#fff;border-radius:10px;display:none}#search-results-container{display:flex;flex-direction:column;width:250px;overflow:auto;padding:20px;border-left:1px solid rgba(255,255,255,.8);color:rgba(255,255,255,.8);background-color:#34323e;position:relative}#pinned-docs,#search-results{flex-grow:1;max-height:50vh;overflow-y:auto;margin-bottom:20px}#pinned-docs h4,#search-results h4{text-decoration:underline;font-size:1.2rem;margin-bottom:10px}#pinned-list li,#results-list li{padding:10px;border-bottom:1px solid rgba(255,255,255,.3);margin-bottom:10px;border-radius:4px;transition:background-color .3s}#pinned-list li:hover,#results-list li:hover{background-color:rgba(255,255,255,.1)}#docreview-logo{margin-bottom:10px}#security-logo{align-self:self-end}a{text-decoration:underline}a:hover{color:#ff0}#help-window{position:absolute;top:50px;transform:translateX(-50%);width:350px;padding:10px 30px;color:#222;z-index:10000}#help-window ul{text-align:left;list-style-type:none;padding:0}#help-window ul li{text-align:left;margin-bottom:10px}#tag-popup{position:fixed;top:50%;transform:translate(-50%,-50%);padding:20px;box-shadow:0 4px 8px rgba(0,0,0,.3);width:300px;z-index:10;font-family:Arial,sans-serif}#tag-popup h3{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;font-size:18px;color:#333}.popup-content{flex-direction:column}.button-group{justify-content:space-between}.icon-button{background:0 0;border:none;font-size:18px;transition:transform .3s;color:#555;display:flex;align-items:center}#tag-color,#tag-input{padding:5px;border-radius:5px}.icon-button:hover{transform:scale(1.2)}.close-btn{font-size:18px;position:absolute;right:10px;top:10px;color:#f33}#tag-input{border:1px solid #ccc;color:#000}#tag-color{border:1px solid #ccc}#tag-list{flex-wrap:wrap}#tag-list li{background-color:#007bff;color:#fff;padding:5px 10px;border-radius:5px}#tag-list li.selected{border:2px solid #333}#tag-list li:hover{background-color:#0056b3}@media (max-width:768px){#search-results-container{width:100%;border-left:none;border-top:1px solid rgba(255,255,255,.8)}#pinned-list li,#results-list li{padding:8px;font-size:.9rem}#docreview-logo,#security-logo{position:static;margin-top:20px}}@media (max-width:600px){#tag-popup{width:90%}}.assigned-tag{display:inline-block;text-align:left;padding:2px 5px;margin-right:5px;margin-bottom:4px;border:1px solid #000;border-radius:3px}
</style>
<!-- CSS Ends Here -->

</head>
<body>
<div id=toolbar>
<button id=folder-select>&#x1F4C2;</button>
<input type=file id=file-input multiple accept=.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.rtf,.jpeg,.jpg,.png,.gif,.tiff style=display:none;text-size:36px>&nbsp;&nbsp;
<button id=prev-doc>&#x23ee;</button>
<select id=document-select style=min-width:140px;max-width:140px></select>
<button id=next-doc>&#x23ed;</button>
<button id=remove-file title="Remove selected file">❌</button>&nbsp;&nbsp;
<button id=prev-page>&#x25c0;</button>
<span style=padding-top:3px;font-weight:700;text-decoration:underline>Page: <span id=page-num></span> / <span id=page-count></span></span>
<button id=next-page>&#x25b6;</button>&nbsp;&nbsp;
<button id=zoom-out>&#x2796;</button>
<button id=zoom-in>&#x2795;</button>
<button id=rotate>&#x1F504;</button>&nbsp;&nbsp;
<input id=search-text placeholder=Search...>
<button id=search-doc>&#128270;</button>
<button id=search style=width:60px>&#128270;&#128270;</button>&nbsp;&nbsp;
<button id=flag-doc><?xml version="1.0" encoding="utf-8"?>
<svg width=17 height=16 viewBox="0 0 17 16" fill=none xmlns=http://www.w3.org/2000/svg><g clip-path=url(#a)><path d="M.826 16c-.37-.16-.43-.43-.18-.75 1.15-1.45 2.37-2.84 3.69-4.13.63-.62 1.25-1.24 1.88-1.88-.04-.05-.08-.09-.12-.13-.82-.83-1.65-1.65-2.47-2.48-.26-.26-.26-.49.01-.74.7-.64 1.75-.69 2.51-.11.03.03.07.05.11.08l4.66-4c-.15-.29-.21-.59-.16-.91.05-.34.2-.62.45-.85.14-.13.35-.13.51-.02.04.03.07.06.11.09 1.45 1.45 2.9 2.9 4.36 4.35.13.13.21.26.15.45a.5.5 0 0 1-.11.2c-.41.43-1.07.55-1.61.31-.08-.03-.13-.05-.2.03-1.29 1.51-2.59 3.02-3.89 4.53-.01.02-.02.03-.04.06.28.34.46.72.48 1.16.04.6-.16 1.1-.58 1.53-.18.19-.43.17-.64-.03-.79-.78-1.57-1.57-2.35-2.35-.04-.04-.07-.09-.11-.15-.07.06-.11.11-.16.15-1.31 1.29-2.57 2.63-3.96 3.84-.64.56-1.3 1.09-1.96 1.63-.07.05-.15.09-.23.13h-.16z" fill=#FF000D /></g><defs><clipPath id=a><path fill=#fff d="M.496 0h15.85v16H.496z"/></clipPath></defs></svg>
</button>
<button id=add-tag>
<svg width=18 height=18 viewBox="0 0 20 14" fill=none xmlns=http://www.w3.org/2000/svg><g clip-path=url(#a)><path d="M.692 9.136v-.329c.071-.402.317-.692.597-.971 2.319-2.311 4.632-4.63 6.954-6.94.165-.165.378-.286.583-.403.125-.073.276-.1.417-.147h5.62c.014.006.026.016.041.019.692.137 1.095.626 1.095 1.337q.002 2.577 0 5.155c0 .457-.162.864-.483 1.187q-3.591 3.602-7.198 7.193c-.143.143-.33.265-.52.334-.54.197-1.002.033-1.398-.364q-2.549-2.554-5.105-5.103c-.28-.278-.529-.566-.602-.968zm11.463-3.689c.679.026 1.265-.544 1.292-1.257.026-.68-.543-1.265-1.257-1.292-.68-.025-1.278.543-1.29 1.258-.01.673.495 1.26 1.255 1.292" fill=#FF000D /></g><defs><clipPath id=a><path fill=#fff d="M.346 0h16v16h-16z"/></clipPath></defs></svg>
</button>
<button id=export-list style=width:35px>
<svg width=20 height=20 viewBox="0 0 16 16" xmlns=http://www.w3.org/2000/svg><path fill=#FF000D fill-rule=evenodd d="M14 9a1 1 0 0 1 1 1v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3a1 1 0 0 1 2 0v3h10v-3a1 1 0 0 1 1-1M8 1a1 1 0 0 1 1 1v4.586l1.293-1.293a1 1 0 1 1 1.414 1.414L8 10.414 4.293 6.707a1 1 0 0 1 1.414-1.414L7 6.586V2a1 1 0 0 1 1-1"/></svg>
</button>
<button id=unpin-all title="Unpin All Documents">
<svg fill=#FF000D width=16 height=16 viewBox="-3 -2 24 24" xmlns=http://www.w3.org/2000/svg preserveAspectRatio=xMinYMin class="jam jam-trash-f"><path d="M12 2h5a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h5V1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1zm3.8 6-.613 9.2a3 3 0 0 1-2.993 2.8H5.826a3 3 0 0 1-2.993-2.796L2.205 8zM7 9a1 1 0 0 0-1 1v7a1 1 0 0 0 2 0v-7a1 1 0 0 0-1-1m4 0a1 1 0 0 0-1 1v7a1 1 0 0 0 2 0v-7a1 1 0 0 0-1-1"/></svg>
</button>
<button id=help-button>
<svg width=16 height=16 viewBox="0 0 16 16" fill=none xmlns=http://www.w3.org/2000/svg><path d="M8.313 0C5.82 0 4.203 1.022 2.935 2.845a.75.75 0 0 0 .162 1.027l1.348 1.022a.75.75 0 0 0 1.039-.13c.783-.98 1.363-1.545 2.586-1.545.961 0 2.15.619 2.15 1.551 0 .705-.581 1.067-1.53 1.599-1.107.62-2.572 1.393-2.572 3.325V10c0 .414.335.75.75.75h2.264a.75.75 0 0 0 .75-.75v-.18c0-1.34 3.915-1.396 3.915-5.02 0-2.73-2.831-4.8-5.484-4.8M8 11.67a2.167 2.167 0 0 0-2.165 2.165C5.835 15.03 6.806 16 8 16a2.167 2.167 0 0 0 2.165-2.165A2.167 2.167 0 0 0 8 11.671" fill=#FF000D /></svg>
</button>&nbsp;
</div>
<div id=content>
<div id=main-content>
<div id=pdf-viewer>
<canvas id=pdf-canvas></canvas>
</div>
<div id=docx-viewer></div>
<div id=xlsx-viewer></div>
<div id=txt-viewer></div>
<img id=image-viewer>
</div>
<div id=search-results-container>
<div id=search-results>
<h4>Search Results</h4>
<ul id=results-list></ul>
</div>
<div id=pinned-docs>
<h4>Pinned Documents</h4>
<ul id=pinned-list></ul>
</div>
<div id=docreview-logo>
<img src=https://documentreview.law/lebel-investigations/IMG_1112.jpg alt="Doc Review Logo">
</div>
<div id=security-logo>
<img src=IMG_1139.png alt="Security Logo">
</div>
</div>
</div>
<div id=tag-popup>
<h3>Manage Tags
<button id=close-tag-popup class="icon-button close-btn">❌</button>
</h3>
<div class=popup-content>
<input id=tag-input placeholder="Enter tag name">
<input type=color id=tag-color value=#007BFF>
<span id=error-message style=color:red;display:none></span>
<div class=button-group>
<button id=save-tag class="icon-button save-btn">
<span style=color:green>✔</span>
</button>
<button id=delete-tag class="icon-button delete-btn"><svg fill=#FF000D width=16 height=16 viewBox="-3 -2 24 24" xmlns=http://www.w3.org/2000/svg preserveAspectRatio=xMinYMin class="jam jam-trash-f"><path d="M12 2h5a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h5V1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1zm3.8 6-.613 9.2a3 3 0 0 1-2.993 2.8H5.826a3 3 0 0 1-2.993-2.796L2.205 8zM7 9a1 1 0 0 0-1 1v7a1 1 0 0 0 2 0v-7a1 1 0 0 0-1-1m4 0a1 1 0 0 0-1 1v7a1 1 0 0 0 2 0v-7a1 1 0 0 0-1-1"/></svg></button>
</div>
<ul id=tag-list></ul>
</div>
</div>
<div id=help-window>
<h5 style="font-size:18px;margin:10px 0;padding:0">We're here to help! Have a question not answered below?</h5><a href=https://documentreview.law/contact/ target=_new style=color:#0bd14b;font-weight:600;text-align:center;font-size:18px>Contact Us Here.</a>
<ul>
<li>&#x1F4C2; - Open Folder/Files</li>
<li>&#x23ee; - Previous Document</li>
<li>&#x23ed; - Next Document</li>
<li>&#x25c0; - Previous Page<sup>*</sup></li>
<li>&#x25b6; - Next Page<sup>*</sup></li>
<li> &#x2796; / &#x2795; - Zoom<sup>*</sup></li>
<li>&#x1F504; - Rotate<sup>*</sup></li>
<li>&#128270; - Search Within Document</li>
<li>&#128270;&#128270; - Search Across Documents</li>
<li>&#x1f4cc; - Pin Document</li>
<li>&#x1f4cc;&#x2b07; - Export List of Pinned Docs (.csv)</li><br>
<li><sup>*</sup>&nbsp;<i>Only for PDFs and Image Files</i></li>
</ul>
<div style=text-align:center;padding:0;margin:0>
<button id=close-help style="color:#0bd14b;font-weight:600;font-size:18px;background:0 0;border:none;cursor:pointer;text-decoration:underline;padding:0;margin:0">Close</button>
</div>
</div>

<!-- JavaScript Starts Here -->
<script>
    // Copyright alert
   alert("ATTN USER: select the folder button on the toolbar to choose a local folder of documents and images for review. This is a CONFIDENTIAL PROTOTYPE for demonstration purposes only. No other use is permitted. \xa9 2024 Adam J Schwartz, All Rights Reserved"),document.getElementById("help-button").addEventListener("click",function(){let e=document.getElementById("help-window");e.style.display="block"}),document.getElementById("close-help").addEventListener("click",function(){let e=document.getElementById("help-window");e.style.display="none"});let pdfDoc=null,pageNum=1,pageCount=0,zoomLevel=1.25,rotationAngle=0,currentDocIndex=0,canvas=document.getElementById("pdf-canvas"),ctx=canvas.getContext("2d"),fileArray=[],pinnedDocs=JSON.parse(localStorage.getItem("pinnedDocs"))||[],tags=JSON.parse(localStorage.getItem("tags"))||[],selectedTagIndex=null;function updateTagList(){let e=document.getElementById("tag-list");e.innerHTML="",tags.forEach((t,n)=>{let l=document.createElement("li");l.textContent=t.name,l.style.backgroundColor=t.color,l.style.color=getContrastColor(t.color),l.addEventListener("click",e=>{e.stopPropagation(),document.querySelectorAll("#tag-list li").forEach(e=>e.classList.remove("selected")),l.classList.add("selected"),selectedTagIndex=n,document.getElementById("tag-input").value=t.name,document.getElementById("tag-color").value=t.color}),e.appendChild(l)})}function getContrastColor(e){e=e.replace("#","");let t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2,2),16),l=parseInt(e.substr(4,2),16);return(299*t+587*n+114*l)/1e3>=128?"black":"white"}function saveTagsToLocalStorage(){localStorage.setItem("tags",JSON.stringify(tags))}function updateTagDropdown(){document.querySelectorAll(".tag-dropdown").forEach(e=>{e.innerHTML='<option value="">Select Tag</option>',tags.forEach(t=>{let n=document.createElement("option");n.value=t.name,n.textContent=t.name,e.appendChild(n)})})}function updatePinnedDocsList(){let e=document.getElementById("pinned-list");e.innerHTML="",pinnedDocs.forEach((t,n)=>{let l=document.createElement("li");l.textContent=t.name;let a=document.createElement("span");a.innerHTML=`
                   <svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#a)" stroke="#FF000D" stroke-miterlimit="10"><path d="M10.431 11.319a1.84 1.84 0 0 1-.56 1.468c-.176.177-.416.162-.61-.032q-1.131-1.13-2.26-2.262c-.04-.037-.068-.087-.108-.14-.067.062-.11.101-.151.141-1.257 1.242-2.468 2.531-3.803 3.691-.615.536-1.253 1.044-1.883 1.563-.065.052-.147.084-.22.126h-.15c-.353-.151-.415-.415-.17-.723a42 42 0 0 1 3.548-3.976c.604-.59 1.198-1.193 1.809-1.802l-.116-.122-2.38-2.38c-.253-.253-.25-.474.013-.714a1.865 1.865 0 0 1 2.412-.102q.044.036.102.08l1.118-.96 3.904 3.903-.919 1.07q-.016.02-.038.055c.273.322.437.692.462 1.114zm6.05-6.544a.5.5 0 0 1-.104.192 1.39 1.39 0 0 1-1.55.303c-.075-.033-.122-.051-.19.027Q13.232 6.94 11.823 8.58L7.919 4.678l3.365-2.89c-.14-.278-.2-.565-.153-.873q.075-.487.431-.82a.39.39 0 0 1 .486-.023 1 1 0 0 1 .102.09l4.186 4.183c.12.12.197.254.146.427z" fill="#FF000D" stroke-width=".249"/><path d="M14.538 11.498 4.237 1.447" stroke-width=".746" stroke-linecap="round"/></g><defs><clipPath id="a"><path fill="#fff" d="M.244 0h16.252v16H.244z"/></clipPath></defs></svg>
                `,a.style.cursor="pointer",a.style.marginLeft="10px",a.addEventListener("click",()=>{unpinDocument(n)});let o=document.createElement("select");o.classList.add("tag-dropdown"),o.innerHTML='<option value="">Select Tag</option>',tags.forEach(e=>{let t=document.createElement("option");t.value=e.name,t.textContent=e.name,o.appendChild(t)}),o.addEventListener("change",()=>{let e=tags.find(e=>e.name===o.value);e&&addTagToDocument(t,e),o.value=""});let i=document.createElement("div");i.style.marginTop="5px",t.tags&&t.tags.forEach(e=>{let n=document.createElement("span");n.textContent=e.name,n.className="assigned-tag",n.style.backgroundColor=e.color,n.style.color=getContrastColor(e.color);let l=document.createElement("span");l.textContent="✖",l.style.marginLeft="5px",l.style.cursor="pointer",l.addEventListener("click",()=>removeTagFromDocument(t,e)),n.appendChild(l),i.appendChild(n)}),l.appendChild(a),l.appendChild(o),l.appendChild(i),e.appendChild(l)}),savePinnedDocsToLocalStorage()}function unpinDocument(e){pinnedDocs.splice(e,1),updatePinnedDocsList()}function addTagToDocument(e,t){e.tags||(e.tags=[]),e.tags.some(e=>e.name===t.name)||(e.tags.push(t),updatePinnedDocsList())}function removeTagFromDocument(e,t){e.tags=e.tags.filter(e=>e.name!==t.name),updatePinnedDocsList()}function savePinnedDocsToLocalStorage(){localStorage.setItem("pinnedDocs",JSON.stringify(pinnedDocs))}function loadDocument(e){if(e<0||e>=fileArray.length)return;currentDocIndex=e;let t=fileArray[e];hideAllViewers();let n="pdf"===t.type,l="image"===t.type;document.getElementById("prev-page").disabled=!n,document.getElementById("next-page").disabled=!n,document.getElementById("zoom-in").disabled=!(n||l),document.getElementById("zoom-out").disabled=!(n||l),document.getElementById("rotate").disabled=!(n||l),n?displayPDF(t.content):"docx"===t.type?displayDocx(t.content):"xlsx"===t.type?displayXlsx(t.content):"txt"===t.type?displayTxtFile(t.content):l&&displayImage(t.content),document.getElementById("document-select").value=e}function hideAllViewers(){document.getElementById("pdf-viewer").style.display="none",document.getElementById("docx-viewer").style.display="none",document.getElementById("xlsx-viewer").style.display="none",document.getElementById("txt-viewer").style.display="none",document.getElementById("image-viewer").style.display="none"}function displayPDF(e){document.getElementById("pdf-viewer").style.display="block",pdfjsLib.getDocument({data:atob(e.split(",")[1])}).promise.then(e=>{pageCount=(pdfDoc=e).numPages,document.getElementById("page-count").textContent=pageCount,rotationAngle=0,renderPage(pageNum=1)})}function displayDocx(e){document.getElementById("docx-viewer").style.display="block",fetch(e).then(e=>e.arrayBuffer()).then(e=>mammoth.convertToHtml({arrayBuffer:e})).then(e=>{document.getElementById("docx-viewer").innerHTML=e.value}).catch(console.error)}function displayXlsx(e){document.getElementById("xlsx-viewer").style.display="block",fetch(e).then(e=>e.arrayBuffer()).then(e=>{let t=XLSX.read(e,{type:"array"}),n=XLSX.utils.sheet_to_html(t.Sheets[t.SheetNames[0]]);document.getElementById("xlsx-viewer").innerHTML=n}).catch(console.error)}function displayTxtFile(e){document.getElementById("txt-viewer").style.display="block",fetch(e).then(e=>e.text()).then(e=>{document.getElementById("txt-viewer").innerText=e}).catch(console.error)}function displayImage(e){document.getElementById("image-viewer").style.display="block",document.getElementById("image-viewer").src=e}function renderPage(e){pdfDoc.getPage(e).then(t=>{let n=t.getViewport({scale:zoomLevel,rotation:rotationAngle});canvas.width=n.width,canvas.height=n.height,canvas.style.width=`${n.width}px`,canvas.style.height=`${n.height}px`,t.render({canvasContext:ctx,viewport:n}).promise.then(()=>{document.getElementById("page-num").textContent=e})})}function adjustImageViewer(){let e=document.getElementById("image-viewer");e.style.transform=`scale(${zoomLevel}) rotate(${rotationAngle}deg)`,e.style.maxWidth=`${100*zoomLevel}%`,e.style.maxHeight=`${100*zoomLevel}%`}function saveFilesToLocalStorage(){localStorage.setItem("savedFiles",JSON.stringify(fileArray))}function loadFilesFromLocalStorage(){let e=JSON.parse(localStorage.getItem("savedFiles"))||[];fileArray=e}function getFileType(e){return e.endsWith(".pdf")?"pdf":/\.(docx)$/i.test(e)?"docx":/\.(xlsx)$/i.test(e)?"xlsx":e.endsWith(".txt")?"txt":/\.(jpeg|jpg|png|gif|tiff)$/i.test(e)?"image":"unknown"}function populateDocumentSelect(){let e=document.getElementById("document-select");e.innerHTML="",fileArray.sort((e,t)=>e.name.localeCompare(t.name)),fileArray.forEach((t,n)=>{let l=document.createElement("option");l.value=n,l.textContent=t.name,e.appendChild(l)}),fileArray.length>0&&(e.value=currentDocIndex),e.addEventListener("change",e=>{loadDocument(parseInt(e.target.value))}),updateRemoveButtonVisibility()}function updateRemoveButtonVisibility(){let e=document.getElementById("remove-file");e.style.display=fileArray.length>0?"inline-block":"none"}function getContrastColor(e){"#"===e.slice(0,1)&&(e=e.slice(1));var t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2,2),16),l=parseInt(e.substr(4,2),16);return(299*t+587*n+114*l)/1e3>=128?"black":"white"}document.getElementById("add-tag").addEventListener("click",()=>{document.getElementById("tag-popup").style.display="block",document.getElementById("tag-input").value="",document.getElementById("tag-color").value="#007BFF",document.getElementById("error-message").style.display="none",selectedTagIndex=null,updateTagList()}),document.getElementById("close-tag-popup").addEventListener("click",()=>{document.getElementById("tag-popup").style.display="none"}),document.getElementById("save-tag").addEventListener("click",e=>{e.stopPropagation();let t=document.getElementById("tag-input").value.trim(),n=document.getElementById("tag-color").value,l=document.getElementById("error-message");if(!t){l.textContent="Tag name can't be empty!",l.style.display="block";return}if(tags.length>=9&&null===selectedTagIndex){l.textContent="You can only create a maximum of 9 tags.",l.style.display="block";return}let a=tags.some(e=>e.name.toLowerCase()===t.toLowerCase());if(a&&null===selectedTagIndex){l.textContent="A tag with this name already exists.",l.style.display="block";return}l.style.display="none",null!==selectedTagIndex?tags[selectedTagIndex]={name:t,color:n}:tags.push({name:t,color:n}),saveTagsToLocalStorage(),document.getElementById("tag-input").value="",document.getElementById("tag-color").value="#007BFF",selectedTagIndex=null,updateTagList(),updateTagDropdown()}),document.getElementById("delete-tag").addEventListener("click",e=>{e.stopPropagation();let t=document.getElementById("error-message");null!==selectedTagIndex?(tags.splice(selectedTagIndex,1),saveTagsToLocalStorage(),updateTagList(),updateTagDropdown(),selectedTagIndex=null,document.getElementById("tag-input").value="",document.getElementById("tag-color").value="#007BFF",t.style.display="none"):(t.textContent="Please select a tag to delete.",t.style.display="block")}),document.getElementById("tag-popup").addEventListener("click",()=>{let e=document.getElementById("error-message");e.style.display="none"}),document.querySelectorAll("#tag-popup input, #tag-popup button").forEach(e=>{e.addEventListener("click",e=>{e.stopPropagation()})}),document.addEventListener("DOMContentLoaded",()=>{updateTagList(),updateTagDropdown(),updatePinnedDocsList()}),document.getElementById("unpin-all").addEventListener("click",()=>{let e=confirm("Are you sure you want to clear all pins and tags? This action cannot be undone. It is recommended you download the record of your pins and tags before proceeding. If you are sure you want to clear all the pins and tags, click delete.");e&&(pinnedDocs=[],updatePinnedDocsList(),alert("All pins and tags have been cleared."))}),document.addEventListener("DOMContentLoaded",()=>{updateTagList(),updatePinnedDocsList()}),document.getElementById("zoom-in").addEventListener("click",()=>{"pdf"===fileArray[currentDocIndex].type?(zoomLevel=Math.min(zoomLevel+.25,3),renderPage(pageNum)):"image"===fileArray[currentDocIndex].type&&(zoomLevel=Math.min(zoomLevel+.25,3),adjustImageViewer())}),document.getElementById("zoom-out").addEventListener("click",()=>{"pdf"===fileArray[currentDocIndex].type?(zoomLevel=Math.max(zoomLevel-.25,.5),renderPage(pageNum)):"image"===fileArray[currentDocIndex].type&&(zoomLevel=Math.max(zoomLevel-.25,.5),adjustImageViewer())}),document.getElementById("rotate").addEventListener("click",()=>{rotationAngle=(rotationAngle+90)%360,"pdf"===fileArray[currentDocIndex].type?renderPage(pageNum):"image"===fileArray[currentDocIndex].type&&adjustImageViewer()}),document.getElementById("prev-page").addEventListener("click",()=>{pageNum>1&&renderPage(--pageNum)}),document.getElementById("next-page").addEventListener("click",()=>{pageNum<pageCount&&renderPage(++pageNum)}),document.getElementById("folder-select").addEventListener("click",()=>{document.getElementById("file-input").click()}),document.getElementById("file-input").addEventListener("change",e=>{let t=[],n=0;for(let l of e.target.files){let a=new FileReader;a.onload=function(a){let o={name:l.name,type:getFileType(l.name),content:a.target.result};t.push(o),++n===e.target.files.length&&(fileArray=[...fileArray,...t],saveFilesToLocalStorage(),populateDocumentSelect(),t.length>0&&loadDocument(fileArray.length-1))},a.readAsDataURL(l)}fileArray.length>0&&loadDocument(0)}),document.getElementById("remove-file").addEventListener("click",()=>{let e=document.getElementById("document-select"),t=parseInt(e.value);t>=0&&(fileArray.splice(t,1),saveFilesToLocalStorage(),populateDocumentSelect(),fileArray.length>0?loadDocument(0):hideAllViewers())}),document.addEventListener("DOMContentLoaded",()=>{loadFilesFromLocalStorage(),populateDocumentSelect(),fileArray.length>0&&loadDocument(0),updateTagList(),updatePinnedDocsList()}),document.getElementById("flag-doc").addEventListener("click",()=>{let e=fileArray[currentDocIndex];pinnedDocs.includes(e)||(pinnedDocs.push(e),updatePinnedDocsList())}),document.getElementById("export-list").addEventListener("click",()=>{if(0===pinnedDocs.length){alert("No pinned documents to export.");return}let e=[];pinnedDocs.forEach(t=>{t.tags&&t.tags.forEach(t=>{e.some(e=>e.name===t.name)||e.push(t)})});let t="data:text/csv;charset=utf-8,Document Name,"+e.map(e=>e.name).join(",")+"\n";pinnedDocs.forEach(n=>{let l=`${n.name},`;e.forEach(e=>{let t=!!n.tags&&n.tags.some(t=>t.name===e.name);l+=t?"1,":"0,"}),t+=l.slice(0,-1)+"\n"});let n=encodeURI(t),l=document.createElement("a");l.setAttribute("href",n),l.setAttribute("download","pinned_documents_with_tags.csv"),document.body.appendChild(l),l.click(),document.body.removeChild(l)}),document.getElementById("prev-doc").addEventListener("click",()=>{currentDocIndex>0&&loadDocument(currentDocIndex-1)}),document.getElementById("next-doc").addEventListener("click",()=>{currentDocIndex<fileArray.length-1&&loadDocument(currentDocIndex+1)}),document.getElementById("search").addEventListener("click",()=>{let e=document.getElementById("search-text").value.toLowerCase(),t=document.getElementById("results-list");t.innerHTML="";let n=!1,l=[];fileArray.forEach((a,o)=>{if("pdf"===a.type){let i=pdfjsLib.getDocument({data:atob(a.content.split(",")[1])}).promise.then(l=>l.getPage(1).then(l=>l.getTextContent().then(l=>{let i=l.items.map(e=>e.str).join(" ");if(i.toLowerCase().includes(e)){n=!0;let d=document.createElement("li"),r=document.createElement("a");r.textContent=a.name,r.href="#",r.style.color="white",r.addEventListener("click",()=>loadDocument(o)),d.appendChild(r),t.appendChild(d)}})));l.push(i)}else if("txt"===a.type){let d=fetch(a.content).then(e=>e.text()).then(l=>{if(l.toLowerCase().includes(e)){n=!0;let i=document.createElement("li"),d=document.createElement("a");d.textContent=a.name,d.href="#",d.style.color="white",d.addEventListener("click",()=>loadDocument(o)),i.appendChild(d),t.appendChild(i)}});l.push(d)}else if("docx"===a.type){let r=fetch(a.content).then(e=>e.arrayBuffer()).then(e=>mammoth.extractRawText({arrayBuffer:e})).then(l=>{let i=l.value;if(i.toLowerCase().includes(e)){n=!0;let d=document.createElement("li"),r=document.createElement("a");r.textContent=a.name,r.href="#",r.style.color="white",r.addEventListener("click",()=>loadDocument(o)),d.appendChild(r),t.appendChild(d)}});l.push(r)}else if("xlsx"===a.type){let s=fetch(a.content).then(e=>e.arrayBuffer()).then(l=>{let i=XLSX.read(l,{type:"array"});i.SheetNames.forEach(l=>{let d=i.Sheets[l],r=XLSX.utils.sheet_to_csv(d);if(r.toLowerCase().includes(e)){n=!0;let s=document.createElement("li"),c=document.createElement("a");c.textContent=a.name,c.href="#",c.style.color="white",c.addEventListener("click",()=>loadDocument(o)),s.appendChild(c),t.appendChild(s)}})});l.push(s)}}),Promise.all(l).then(()=>{if(!n){let e=document.createElement("li");e.textContent="No matches found",e.style.color="white",t.appendChild(e)}})}),document.getElementById("search-doc").addEventListener("click",()=>{let e=document.getElementById("search-text").value.toLowerCase(),t=document.getElementById("results-list");if(t.innerHTML="","pdf"===fileArray[currentDocIndex].type){let n=[];for(let l=1;l<=pageCount;l++)pdfDoc.getPage(l).then(a=>{a.getTextContent().then(a=>{let o=a.items.map(e=>e.str).join(" ");if(o.toLowerCase().includes(e)){n.push(l);let i=document.createElement("li"),d=document.createElement("a");d.textContent=`Page ${l}`,d.href="#",d.style.color="white",d.addEventListener("click",()=>{renderPage(pageNum=l)}),i.appendChild(d),t.appendChild(i)}})})}else"txt"===fileArray[currentDocIndex].type?fetch(fileArray[currentDocIndex].content).then(e=>e.text()).then(n=>{let l=n.split("\n");l.forEach((n,l)=>{if(n.toLowerCase().includes(e)){let a=document.createElement("li");a.textContent=`Line ${l+1}: ${n}`,a.style.color="white",t.appendChild(a)}}),""===t.innerHTML&&(t.innerHTML="<li>No matches found</li>")}):t.innerHTML="<li>Search is not supported for this file type</li>"}),document.getElementById("search-text").addEventListener("keypress",e=>{"Enter"===e.key&&document.getElementById("search-doc").click()});
    </script>
    <!-- // JavaScript Ends Here -->

</body>
</html>
<!-- HTML Ends Here -->